(()=>{function e(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return n(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,c=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return l=e.done,e},e:function(e){c=!0,i=e},f:function(){try{l||null==a.return||a.return()}finally{if(c)throw i}}}}function n(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}jQuery(document).ready(function(n){function t(t,a){var o,r={address_line_1:"",address_line_2:"",city:"",state:"",zip:"",country:""},i=e(t.address_components);try{for(i.s();!(o=i.n()).done;){var c=o.value;switch(c.types[0]){case"street_number":if(l(t.name,c.long_name))break;r.address_line_1="".concat(c.long_name," ").concat(r.address_line_1).trim();break;case"route":if(l(t.name,c.short_name))break;r.address_line_1?r.address_line_1+=" "+c.short_name:r.address_line_1=c.short_name;break;case"postal_code":r.zip="".concat(c.long_name).concat(r.zip);break;case"postal_code_suffix":r.zip="".concat(r.zip,"-").concat(c.long_name);break;case"locality":case"postal_town":r.city=c.long_name;break;case"administrative_area_level_1":r.state||r.country?!r.state&&r.country:r.state=c.long_name;break;case"administrative_area_level_2":!r.state&&r.country&&(r.state=c.long_name);break;case"administrative_area_level_3":case"administrative_area_level_4":r.address_line_2?r.address_line_2=" "+c.short_name:r.address_line_2=c.short_name;case"country":r.country=c.short_name}}}catch(e){i.e(e)}finally{i.f()}if(r.address_line_1||(r.address_line_1=t.name),t.latLng){var s=a.closest("form");s.find("input[data-key_name='latitude']").val(t.latLng.lat),s.find("input[data-key_name='longitude']").val(t.latLng.lng)}t.name!=r.address_line_1&&void 0!==t.name&&(a.find("input[data-key_name='address_line_2']").length?(r.address_line_2=r.address_line_1,r.address_line_1=t.name):r.address_line_1=t.name+" "+r.address_line_1),a.find(":input").val("").trigger("change"),n.each(r,(function(e,n){n&&("country"==e?a.find("select[data-key_name='"+e+"']").val(n).trigger("change"):a.find("input[data-key_name='"+e+"']").val(n).trigger("change"))}))}function a(e,a,o){if(void 0!==o.data("ff_with_g_map")){var r=n(e).closest(".ff_map_autocomplete");if($mapDom=r.find(".ff_g_map"),$mapDom.length||(n("<div/>",{class:"ff_g_map",id:"ff_map_elm_"+n(e).attr("id"),style:"height:300px"}).appendTo(r),$mapDom=r.find(".ff_g_map")),document.getElementById($mapDom.attr("id"))){var i=new google.maps.Map(document.getElementById($mapDom.attr("id")),{center:{lat:50.064192,lng:-130.605469},zoom:3}),l=new google.maps.Marker({map:i,draggable:!0,anchorPoint:new google.maps.Point(0,-29)});if(l.setVisible(!1),!a.geometry||!a.geometry.location)return;google.maps.event.addListener(l,"dragend",(function(e){(new google.maps.Geocoder).geocode({latLng:e.latLng},(function(n,a){a==google.maps.GeocoderStatus.OK&&n[0]&&(n[0].latLng=e.latLng,t(n[0],o))}))})),a.geometry.viewport?i.fitBounds(a.geometry.viewport):(i.setCenter(a.geometry.location),i.setZoom(17)),l.setPosition(a.geometry.location),l.setVisible(!0)}}}function o(e,o){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){var r={lat:n.coords.latitude,lng:n.coords.longitude};(new google.maps.Geocoder).geocode({latLng:r},(function(n,i){i==google.maps.GeocoderStatus.OK&&n[0]&&(n[0].latLng=r,t(n[0],o),a(e,n[0],o))}))}),(function(){r().then((function(t){t?i(e,t,o):n(e).val("")}))})):r().then((function(t){t?i(e,t,o):n(e).val("")}))}function r(){var e=window.ff_gmap_vars.api_key;return fetch("https://www.googleapis.com/geolocation/v1/geolocate?key="+e,{method:"POST",headers:{"Content-Type":"application/json"}}).then((function(e){if(console.log(e),!e.ok)throw new Error("Google IP Geolocation failed");return e.json()})).then((function(e){return{lat:e.location.lat,lng:e.location.lng,accuracy:e.accuracy}})).catch((function(e){return console.error("Error fetching IP location:",e),null}))}function i(e,n,o){(new google.maps.Geocoder).geocode({latLng:n},(function(r,i){i==google.maps.GeocoderStatus.OK&&r[0]&&(r[0].latLng=n,t(r[0],o),a(e,r[0],o))}))}function l(e,n){return e&&e.includes(n)}n(document).on("elementor/popup/show",(function(e,n,t){window.fluentform_gmap_callback()})),window.fluentform_gmap_callback=function(){n(".ff_map_autocomplete").each((function(e,r){var i=n(r),l=i.find("input[data-key_name='address_line_1']").attr("id"),c=i.find("#"+l)[0],s=void 0!==i.data("ff_with_auto_locate")&&i.data("ff_with_auto_locate"),d=new google.maps.places.Autocomplete(c,{fields:["formatted_address","name","address_components","geometry","icon"]});if($country=i.find("select[data-key_name='country']"),$country.length){var _=$country.data("autocomplete_restrictions"),u=[];for(var m in _)u.push(_[m]);u.length>0&&d.setComponentRestrictions({country:u})}s&&"no"!=s&&("on_load"==s&&o(c,i),n(c).parent().find(".ff_input-group-append").on("click",(function(){n(c).val("Please wait .."),o(c,i)})));d.addListener("place_changed",(function(){var e=d.getPlace();e.latLng=e.geometry.location,a(c,e,i),t(e,i)}))}))}}(jQuery))})();