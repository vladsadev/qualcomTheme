(()=>{function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}!function(t){var a=window.fluentformpro_post_update_vars.post_selector,r=null,i={};function o(e){return e.closest("form")}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t||(t=""),"string"!=typeof t&&(t=t.length>0?t.map((function(e){return e.value?e.value.toString():e.toString()})):t.toString()),e.hasClass("ff_has_multi_select")?e.data("choicesjs")&&(e.data("choicesjs").removeActiveItems(t),e.data("choicesjs").setChoiceByValue(t)):e.val(t)}function s(a){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=!1;"string"!=typeof i&&"number"!=typeof i||("1"===i&&(o=!0),i=i.includes(",")?i.split(","):[i]),"object"!==n(i)||Array.isArray(i)||(i=Object.keys(i));var l=(i=(r=[]).concat.apply(r,e(i))).map((function(e){return e.value?e.value.toString().trim():e.toString().trim()}));a.each((function(e,n){var a=t(n);-1!==t.inArray(a.val(),l)||"on"===a.val()&&o?(a.closest(".ff-el-form-check").addClass("ff_item_selected"),a.prop("checked",!0)):a.prop("checked",!1)}))}function f(e,n,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"img";if(Array.isArray(n)&&n.length>0)t.each(n,(function(t,n){f(e,n,a,r)}));else{var i=p(n),o='<input type="hidden" data-clear_on_post_change="1" name="remove-attachment-key-'.concat(a,'[]" value="').concat(i,'">'),l=d(e,n,o,r);i&&e.closest(".ff-el-input--content").append('<input type="hidden" data-clear_on_post_change="1" name="existing-attachment-key-'.concat(a,'[]" value="').concat(i,'">')),e.closest(".ff-el-input--content").append(l)}}function c(e,n){var a="Something is wrong when doing ajax request! Please try again";e.responseJSON&&e.responseJSON.data&&e.responseJSON.data.message?a=e.responseJSON.data.message:e.responseJSON&&e.responseJSON.message?a=e.responseJSON.message:e.responseText&&(a=e.responseText);var r=t("<div/>",{class:"error text-danger"});n.closest(".ff-el-group").addClass("ff-el-is-error"),n.closest(".ff-el-input--content").find("div.error").remove(),n.closest(".ff-el-input--content").append(r.text(a))}function d(e,n,a){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"img";if(!n||Array.isArray(n)&&!n.length)return"";"image"===(null===(r=n)||void 0===r?void 0:r.type)&&(i="img");var o=t("<div/>",{class:"ff-post-update-thumb-wrapper",css:{position:"relative","margin-bottom":"15px"}}),l=t("<span/>",{text:"X",title:"Remove "+("file"===i?"File":"Image"),"data-attachment-id":p(n),css:{position:"absolute",background:"#f00","border-radius":"50%",color:"#fff",right:"-3px",top:"-3px",width:"15px",height:"15px",display:"flex","align-items":"center","justify-content":"center","font-weight":"700","font-size":"10px",cursor:"pointer","z-index":1},on:{click:function(){t(this).closest(".ff-el-input--content").append(a),o.remove(),u()}}}),s="";if("string"==typeof n&&"file"===i){var f=n.split(/(\\|\/)/g).pop(),c=f.split(".").pop().toLowerCase().trim();if(!["png","jpg","gif","jpeg","webp","bmp"].includes(c)){var d={};d.url=n,d.filename=f,d.filesize=function(e){var t=0,n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(null),200===n.status&&(t=n.getResponseHeader("content-length"));return parseInt(t)}(n),n=d}}if("file"===i&&"string"!=typeof n)s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:140;return t-=91,e.filesize=(null==e?void 0:e.filesize)||(null==e?void 0:e.filesizeInBytes),'\n                    <div class="ff-upload-preview" data-src="">\n                        <div class="ff-upload-thumb">\n                            <div class="ff-upload-preview-img" style="background-image: url(\''.concat(null==e?void 0:e.url,'\');">\n                            \n                            </div>\n                        </div>\n                        <div class="ff-upload-details">\n                            <div class="ff-upload-filename" style="max-width: ').concat(t,'px;">').concat(null!=e&&e.filename?e.filename:null==e?void 0:e.name,'</div>\n                                <div class="ff-upload-progress-inline ff-el-progress">\n                                    <div class="ff-el-progress-bar" style="width: 100%;"></div>\n                                </div>\n                                <div class="ff-upload-filesize ff-inline-block">').concat(null!=e&&e.filesize?(e.filesize/1024).toFixed(2):0,' KB</div>\n                                <div class="ff-upload-error" style="color:red;"></div>\n                            </div>\n                        </div>\n                    </div>\n               ')}(n,parseInt(e.closest(".ff-el-group").width()));else{var m;if("string"!=typeof n)n=null===(m=n)||void 0===m?void 0:m.url;s='<div style="max-width: 200px;"><img class="ff-post-update-thumb" style="width: 100%;" src="'+n+'" ></div>'}return o.append(l).append(s),o}function p(e){return"string"==typeof e?"":(null==e?void 0:e.ID)||(null==e?void 0:e.id)||""}function u(){$form=o(t("#"+a));var e=$form.find("input[type='file']");t.each(e,(function(e,n){var a=t(n);if(a.closest(".ff-el-group").find(".ff-el-input--label").hasClass("ff-el-is-required")){var r=a.attr("name").replace("[","").replace("]","");if(a.closest(".ff-el-input--content").find(".ff-post-update-thumb-wrapper").length){var o=window.fluentFormApp($form);null==o||o.removeFieldValidationRule(r,"required")}else if(r in i){var l=window.fluentFormApp($form);null==l||l.addFieldValidationRule(r,"required",i[r])}}}))}t(document).on("change","#"+a,(function(e){var n=this,a=t(this).val(),i=o(t(this));if(function(e){var t=e.find(".ff-post-update-thumb-wrapper");t.length&&t.remove();e.find('input[data-clear_on_post_change="1"]').remove()}(i),r&&function(e){var t=e.find(".ff-el-repeater.js-repeater table tbody");t.find("tr").remove(),t.append(r)}(i),a){var p=i.attr("data-form_id");jQuery.post(window.fluentFormVars.ajaxUrl,{action:"fluentformpro_get_post_details",post_id:a,form_id:p,fluentformpro_post_update_nonce:window.fluentformpro_post_update_vars.nonce}).then((function(e){e.data.post?(!function(e,n){t.each(e,(function(e,t){if("post_content"===e)window.wpActiveEditor&&tinyMCE.get(wpActiveEditor).setContent(t);else if("thumbnail"===e){var a=n.find("input[name='featured_image']");if(a.length&&t){var r=d(a,t,'<input type="hidden" data-clear_on_post_change="1" name="remove_featured_image" value="1">');a.closest(".ff-el-input--content").append(r)}}else"post_excerpt"===e?n.find("textarea[name='"+e+"']").val(t).trigger("change"):n.find("input[name='"+e+"']").val(t).trigger("change")}))}(e.data.post,i),function(e,n){t.each(e,(function(e,t){var a=n.find('[data-name="'+e+'"]');if("select"===a.attr("type"))l(a,t);else if("checkbox"===a.attr("type")||"radio"===a.attr("type"))s(a,t);else{var r=t.map((function(e){return e.label})).join(",");a.val(r)}a.change()}))}(e.data.taxonomy,i),["custom_meta","acf_metas","advanced_acf_metas","mb_general_metas","mb_advanced_metas","jetengine_metas","advanced_jetengine_metas"].forEach((function(n){var a=e.data[n];!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.each(e,(function(e,t){!function(e,t){var n=t.name;n.includes(".")&&(n=n.split(".").join("[")+"]");var a=t.value,i=e.find('[data-name="'+n+'"]');i.length||(i=e.find('[name="'+n+'"]'));if(i.length){switch(t.type){case"image":case"image_upload":case"single_image":case"gallery":case"media":f(i,a,n,"img");break;case"file":case"file_upload":case"file_input":case"file_advanced":f(i,a,n,"file");break;case"select":case"image_select":case"checkbox":case"radio":case"button_group":case"checkbox_list":!function(e,t){var n="select"===e.attr("type")||"select"===e.prop("nodeName").toLowerCase();n?l(e,t):s(e,t)}(i,a);break;case"date_picker":case"date_time_picker":case"time_picker":case"jetengine_date_type":!function(e,t,n){var a;"date_picker"===n?a="Ymd":"date_time_picker"===n?a="Y-m-d H:i:s":"time_picker"===n&&(a="H:i:s");if(e.length>0&&e[0]._flatpickr){var r=e[0]._flatpickr,i=r.parseDate(t,a)||t;r.setDate(i)}else e.val(t)}(i,a,t.type);break;case"repeater":!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t||null==t||!t.length)return;var n=e.find("table"),a=n.find("tbody tr"),i=parseInt(n.attr("data-max_repeat"));t.forEach((function(e){var t=n.find("tbody tr").length-1;if(i&&t===i)n.addClass("repeat-maxed");else{var o=a.clone();r||(r=a.clone());var l=Object.values(e);o.find("td").each((function(e,t){var n=jQuery(this).find(".ff-el-form-control:last-child"),a=n.attr("data-mask");a&&n.mask(a);var r="ffrpt-"+(new Date).getTime()+e,i={value:l[e]||"",id:r};n.prop(i)})),o.insertBefore(a)}})),a.remove();var o=n.attr("data-root_name"),l=0;n.find("tbody tr").each((function(e,t){jQuery(this).find(".ff-el-form-control").each((function(t,n){var a=jQuery(n);0===e&&(l=a.attr("tabindex")),a.prop({name:o+"["+e+"][]"}),a.attr("data-name",o+"_"+t+"_"+e),l&&a.attr("tabindex",l)}))})),n.trigger("repeat_change")}(i,a);break;case"wysiwyg":if(i.hasClass("fluentform-post-content")){var o,c=i.attr("id")||"";null===(o=tinyMCE.get(c))||void 0===o||o.setContent(a)}else i.val(a);break;default:"string"==typeof a&&i.val(a)}i.change()}}(n,t)}))}(a||[],i)})),u()):c(e,t(n))})).fail((function(e){c(e,t(n))})).always((function(){}))}else i.trigger("reset")})),setTimeout((function(){t("#"+a).change()}),500);var m=t("#"+a);if(m.length){$theForm=o(m);var v=$theForm.find("input[type='file']");t.each(v,(function(e,n){var a=t(n).attr("name").replace("[","").replace("]","");if(t(n).closest(".ff-el-group").find(".ff-el-input--label").hasClass("ff-el-is-required")&&a){var r=$theForm.attr("data-form_instance"),o=window["fluent_form_"+r];o&&o.rules[a]&&o.rules[a].required&&(i[a]=o.rules[a].required)}}))}}(jQuery)})();